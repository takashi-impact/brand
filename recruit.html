<!DOCTYPE html>
<html lang="ja">
<head>

<!-- Advocate -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/10.9.0/jsrsasign-all-min.js"></script>
<script type="text/javascript"> (function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('https://impact.msademo.net/A6108791-de00-46db-9400-014533654bf765535.js','script','ire',document,window); ire('identify', {customerid: '' /*INSERT CUSTOMER ID*/, customeremail: '' /*INSERT SHA1 HASHED CUSTOMER EMAIL*/});
</script>
<script>
    function generateImpactJWT(userId, accountSid, authToken) {
        // Header
        const oHeader = { alg: 'HS256', typ: 'JWT' };
        
        // Payload
        const oPayload = {
            sub: userId,        // User ID (customeridと同じ値にする必要があります)
            iss: accountSid,    // Impact Account SID
            iat: Math.floor(Date.now() / 1000) // 発行時刻
        };

        // 署名 (HS256)
        const sHeader = JSON.stringify(oHeader);
        const sPayload = JSON.stringify(oPayload);
        
        // jsrsasignを使って署名付きトークンを生成
        return KJUR.jws.JWS.sign("HS256", sHeader, sPayload, authToken);
    };

    // 1. When UTT is ready, run the following function.
    window.impactOnReady = function () {
      // 2. Make the request to retrieve referral information from the dropped cookie
      //  Cookies are dropped after a user clicks on a sharelink
      //  This cookie includes important referral information such as the referrer's referral code
      //  To read more on our referral cookies see https://integrations.impact.com/impact-brand/docs/tracking-cookies-for-advocate-programs
      impact
      .api()
      .referralCookie()
      .then(function (response) {
        // 3. Adding a short wait helps to insure that the value is properly set in the form
        const waitForElement = setInterval(function () {
    
          // 4. Retrieve the element you want to auto-fill the referral code into from the DOM.
          const el = document.getElementsByName("impact_referralcookies");
    
          if (el.length) {
            clearInterval(waitForElement);
    
            // 5. Set the value of the form field to be the participants referral cookie
            el[0].value = response.encodedCookie;
          }
        }, 100);
      });
      
      const IMPACT_ACCOUNT_SID = 'IR37qk9K6nbZ6108791wKWEmgxr9v65535'; // ImpactのアカウントSID
      const IMPACT_AUTH_TOKEN = 'cpAPoXp.kTrx.x2ducxjbgtskaE3Hdys';   // ImpactのAuth Token (秘密鍵)
      
      const myJwt = generateImpactJWT(id, IMPACT_ACCOUNT_SID, IMPACT_AUTH_TOKEN);

      const id = `user_${new Date().getTime()}`; // Unique ID based on timestamp
      const accountId = `account_${new Date().getTime()}`; // Unique Account ID based on timestamp
      const email = `user${new Date().getTime()}@example.com`; // Unique email based on timestamp
      


      const userConfig = {
          // 2b. Add details about your user
          //  This must include id and account id but other fields such as email, first name, locale or even custom fields can be included
          //  For more details and a list of user fields see https://integrations.impact.com/impact-brand/docs/install-the-utt
        
          user: {                               
            // SHA1 hashed emails can also be used for id and accountId fields
            id: id,                      
            accountId: accountId,       
            email: email,               
          },
          jwt: myJwt 
      };
      // 3. Make the request to upsert your user.
      impact.api().upsertUser(userConfig).then(function(response) {
          // The widget API automatically inserts the HTML for your widget into your page via an iFrame
          // However if needed, you can retrieve details about the upserted user and the widget HTML through this function response
          const user = response.user;
      }).catch(function(error){
          console.log(error);
      });
    };
  </script>
<!-- /Advocate -->
      

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ケーキショップ向け 無料ホームページテンプレート tp_cute2</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="ここにサイト説明を入れます">
<meta name="keywords" content="キーワード１,キーワード２,キーワード３,キーワード４,キーワード５">
<link rel="stylesheet" href="css/style.css">
<script src="js/openclose.js"></script>
<script src="js/fixmenu_pagetop.js"></script>

<!-- toaster -->
<!-- https://phiary.me/toastr-usage/ -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<link href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet" />
<script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
<!-- /toaster -->
<!-- Load tags.html -->
<!-- <script>
    $(function(){
        $.get('tags.html',function(data){
            $("body").append(data);
        });
    });
</script> -->
<!-- Load tags.html -->

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body>

<div id="container">

<header>
<h1 id="logo"><a href="index.html"><img src="images/logo2.png" alt="Macaroon Shop"></a></h1>
<h2>RECRUIT<span>お友達紹介</span></h2>
<!--PC用（901px以上端末）メニュー-->
<nav id="menubar">
<ul>
<li><a href="index.html"><span>Home</span><span>ホーム</span></a></li>
<li><a href="about.html"><span>About</span><span>ショップについて</span></a></li>
<li><a href="menu.html"><span>Macarron</span><span>マカロンメニュー</span></a></li>
<li><a href="access.html"><span>Access</span><span>アクセス</span></a></li>
<li><a href="recruit.html"><span>Recruit</span><span>お友達紹介</span></a></li>
</ul>
<ul class="icon">
<li><a href="#"><img src="images/icon_facebook.png" alt="Facebook"></a></li>
<li><a href="#"><img src="images/icon_twitter.png" alt="Twitter"></a></li>
<li><a href="#"><img src="images/icon_instagram.png" alt="Instagram"></a></li>
<li><a href="#"><img src="images/icon_youtube.png" alt="YouTube"></a></li>
<li><a href="#"><img src="images/icon_line.png" alt="LINE"></a></li>
</ul>
</nav>
</header>

<!--小さな端末用（900px以下端末）ブロック-->
<nav id="menubar-s">
<ul>
<li><a href="index.html"><span>Home</span><span>ホーム</span></a></li>
<li><a href="about.html"><span>About</span><span>ショップについて</span></a></li>
<li><a href="menu.html"><span>Macarron</span><span>マカロンメニュー</span></a></li>
<li><a href="access.html"><span>Access</span><span>アクセス</span></a></li>
<li><a href="recruit.html"><span>Recruit</span><span>お友達紹介</span></a></li>
</ul>
<ul class="icon">
<li><a href="#"><img src="images/icon_facebook.png" alt="Facebook"></a></li>
<li><a href="#"><img src="images/icon_twitter.png" alt="Twitter"></a></li>
<li><a href="#"><img src="images/icon_instagram.png" alt="Instagram"></a></li>
<li><a href="#"><img src="images/icon_youtube.png" alt="YouTube"></a></li>
<li><a href="#"><img src="images/icon_line.png" alt="LINE"></a></li>
</ul>
</nav>

<div id="main">

<section>

<h2>お友達紹介</h2>
<!-- <impact-popup widget="w/demo-widget-1"><button>Click me!</button></impact-popup> -->
<impact-embed widget="w/demo-widget-1"><div>Loading...</div></impact-embed>
<!--/#main-->

<footer>
<small>Copyright&copy; <a href="index.html">Macaroon Shop</a> All Rights Reserved.</small>
<span class="pr"><a href="https://template-party.com/" target="_blank">《Web Design:Template-Party》</a></span>
</footer>

</div>
<!--/#container-->

<!--ページの上部に戻るボタン-->
<p class="nav-fix-pos-pagetop"><a href="#"><img src="images/icon_pagetop.png" alt="↑"></a></p>

<!--メニュー開閉ボタン-->
<div id="menubar_hdr" class="close"></div>

<!--メニューの開閉処理-->
<script>
open_close("menubar_hdr", "menubar-s");
</script>

</body>
</html>
